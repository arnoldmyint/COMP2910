<!DOCTYPE html>
<html lang="en">
<head>
    <title>The Ball Game</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1, maximum-scale=1, user-scalable=0" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
    <link rel="stylesheet" href="">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.2/jquery.min.js"></script>
    <style>
        /* make the body fill the window */

        html, body {
            margin: 0px;
            width: 100%;
            height: 100%;
            overflow: hidden;
        }
        /* make any canvas fill its container */
        canvas {
            width: 100%;
            height: 100%;
            background-color: cornflowerblue;
            position: center;
        }
    </style>
    <script type="text/javascript">
        var c=0;
        function load(){
            canvas=document.getElementById("mycanvas");
            var ctx=canvas.getContext("2d");
            //canvas.width=window.innerWidth*window.devicePixelRatio;
            //canvas.height=window.innerHeight*window.devicePixelRatio;
            $(window).resize(function() {
                var width = $(this).width();
                var height = $(this).height();
                $('#mycanvas').attr("width", width*window.devicePixelRatio);
                $('#mycanvas').attr("height", height*window.devicePixelRatio);
                floor(arr,ctx);
                right_wall(arr,ctx);
                left_wall(arr,ctx);
            });
            var arr=[];
            var rows=0;
            var cols=0;
            for(var i=0; i<64; i++){
                var rectObj={
                    width:30,height:30,color:"grey",x:0,y:0,index:0,type:null
                }
                if(i%8==0){
                    rows++;
                    cols=0;
                }
                rectObj.x=cols*rectObj.width;
                rectObj.y=rows*rectObj.height;
                rectObj.index=i;
                arr.push(rectObj);
                cols++;
            }
            //ctx.save();
            floor(arr,ctx);
            right_wall(arr,ctx);
            left_wall(arr,ctx);
            addBox(arr, ctx);
            //var myVar = setInterval(function(){floor(arr,ctx),right_wall(arr,ctx)}, 100);
        }
        function floor(arr, ctx){
            for(var i=0; i<arr.length; i++){
                ctx.beginPath();
                ctx.fillStyle="#A19E9C";
                ctx.setTransform(1,0.4,-1,0.5,410,400);
                ctx.strokeRect(arr[i].x,arr[i].y,arr[i].width,arr[i].height);
                ctx.fillRect(arr[i].x,arr[i].y,arr[i].width,arr[i].height);
                arr[i].type="floor";
            }
            //alert(arr[0].type);
            if(randomize(arr,ctx)%55 == 0){
                c=0;
                for(var i=0; i<64; i++){
                    arr[i].color = "LightGrey";
                }
            }
        }
        function right_wall(arr,ctx){
            for(var i=0; i<arr.length; i++){
                ctx.beginPath();
                ctx.fillStyle="DarkGrey";
                ctx.setTransform(1,0.4,0,1,380,145);
                ctx.strokeRect(arr[i].x,arr[i].y,arr[i].width,arr[i].height);
                ctx.fillRect(arr[i].x,arr[i].y,arr[i].width,arr[i].height);
                arr[i].type="right_wall";
            }
            //alert(arr[0].type);
            if(randomize(arr,ctx)%55 == 0){
                c=0;
                for(var i=0; i<64; i++){
                    arr[i].color = "DarkGrey";
                }
            }
        }

        function left_wall(arr,ctx){
            for(var i=0; i<arr.length; i++){
                ctx.beginPath();
                ctx.fillStyle="Grey";
                ctx.setTransform(1,-0.495,0,1,140,264);
                ctx.strokeRect(arr[i].x,arr[i].y,arr[i].width,arr[i].height);
                ctx.fillRect(arr[i].x,arr[i].y,arr[i].width,arr[i].height);
            }
        }
        /*
        generate the random cells for holes and balls
         */
        function randomize(arr,ctx) {
            do {
                var i = parseInt(64 * Math.random());
                //add constraint of the holes and balls
                if ((arr[i].index < 8 && arr[i].type == "floor") || (arr[i].index > 55 && arr[i].type == "right_wall")) {
                    arr[i].color = "red";
                }
            } while (arr[i].color == "red");

            arr[i].color = "red";
            ctx.fillStyle = arr[i].color;
            ctx.fillRect(arr[i].x, arr[i].y, arr[i].width, arr[i].height);
            return c++;
        }
        /*
        function resize(canvas) {
            // Lookup the size the browser is displaying the canvas.
            var displayWidth  = canvas.clientWidth;
            var displayHeight = canvas.clientHeight;

            // Check if the canvas is not the same size.
            if (canvas.width  != displayWidth ||
                    canvas.height != displayHeight) {

                // Make the canvas the same size
                canvas.width  = displayWidth;
                canvas.height = displayHeight;
            }
        }
        */
        /*
        function resize(gl) {
            var realToCSSPixels = window.devicePixelRatio || 1;
            // Lookup the size the browser is displaying the canvas in CSS pixels
            // and compute a size needed to make our drawingbuffer match it in
            // device pixels.
            var displayWidth  = Math.floor(gl.canvas.clientWidth  * realToCSSPixels);
            var displayHeight = Math.floor(gl.canvas.clientHeight * realToCSSPixels);

            // Check if the canvas is not the same size.
            if (gl.canvas.width  != displayWidth ||
                    gl.canvas.height != displayHeight) {

                // Make the canvas the same size
                gl.canvas.width  = displayWidth;
                gl.canvas.height = displayHeight;

                // Set the viewport to match
                gl.viewport(0, 0, gl.canvas.width, gl.canvas.height);
            }
        }
*/

        function addBox(arr, ctx){
            box_image = new Image();
            box_image.src = 'block_image.png';
            ctx.translate(50, 35);
            ctx.rotate(0.2);
            box_image.onload = function(){
                ctx.drawImage(box_image, 210, 160, 50, 60);
            }
        }
    </script>
</head>
<body onload="load()">
    <canvas id="mycanvas" width="800" height="800">
        <p>Your browser does not support canvas</p>
    </canvas>
</body>
</html>